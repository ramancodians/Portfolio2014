// Set-up ===============================================================================
var express=require("express"),app=express(),compression=require("compression"),oneDay=864e5,mongoose=require("mongoose"),db=require("./config/db"),port=process.env.PORT||8080,path=require("path"),morgan=require("morgan"),bodyParser=require("body-parser"),methodOverride=require("method-override"),nodemailer=require("nodemailer");mongoose.connect(db.url);app.use(express.static(path.join(__dirname,"/public")));app.use(morgan("dev"));app.use(bodyParser.urlencoded({extended:"true"}));app.use(bodyParser.json());app.use(bodyParser.json({type:"application/vnd.api+json"}));app.use(methodOverride());var transporter=nodemailer.createTransport({service:"Gmail",auth:{user:"whymynameisalexisbertin@gmail.com",pass:"jillislucky6"}});app.post("/sendMessage",function(e,t){var n={from:e.query.mail,to:"whymynameisalexisbertin@gmail.com",subject:"Portfolio | Contact from: "+e.query.name,html:'<p style="font-size: 16px; line-height: 24px;"><span style="font-weight:bold">Name: </span> <span style="color: #15c">'+e.query.name+'</span> <br /><span style="font-weight:bold">Mail: </span> <span style="color: #15c">'+e.query.mail+'</span> <br /><span style="font-weight:bold">Message: </span> <br /><span style="color: #15c">'+e.query.message+"</span></p>",text:e.query.name+" | "+e.query.mail+" | "+e.query.message};transporter.sendMail(n,function(e,n){e?t.send("NOPENOPEN: "+e):t.send("Message sent: "+n.response)})});app.get("*",function(e,t){t.sendfile("./public/index.html")});app.listen(port);console.log("App listening on port **"+port+"**");